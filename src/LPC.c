/*
 ============================================================================
 Name        : LPC.c
 Author      :
 Version     :
 Copyright   : Your copyright notice
 Description : Hello World in C, Ansi-style
 ============================================================================
 */

#include <stdio.h>
#include <stdlib.h>
#include <math.h>

#define INPUT_SIZE 6000
#define WINDOW_SIZE 3825
#define NUM_FRAMES 74
#define FRAME_SIZE 175
#define FRAME_OFFSET 50
#define ORDER 9
#define DC_OFFSET 512
#define PI 3.141592653589793238462643383279502884L

float test[] = {512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,508,508,508,508,508,508,508,508,508,508,508,508,508,508,508,508,508,508,512,512,512,512,512,512,512,512,516,516,516,516,516,516,516,520,520,520,520,520,520,520,520,520,520,524,524,524,524,528,524,524,524,524,520,516,512,508,500,496,492,484,480,480,480,476,480,484,488,488,492,496,500,504,508,512,512,512,516,520,520,520,520,520,520,520,516,516,516,516,516,516,516,516,516,516,516,516,520,520,524,524,528,532,532,536,540,540,540,544,540,540,536,532,524,516,512,496,488,480,472,464,464,460,460,464,468,472,480,484,492,496,500,508,512,512,516,520,524,524,524,528,524,524,524,524,524,520,520,520,520,516,516,516,516,516,516,516,516,520,520,520,524,524,524,528,528,528,528,524,524,524,520,516,512,512,508,508,508,504,504,504,504,504,504,504,504,504,504,504,504,500,500,496,496,496,496,496,496,500,500,504,504,508,512,512,516,516,520,520,524,524,524,524,524,524,520,520,516,516,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,516,516,520,524,524,528,532,532,536,536,536,536,532,528,524,516,504,496,488,476,464,460,460,460,460,468,472,480,488,496,504,512,516,520,528,532,536,540,540,540,540,536,532,528,524,520,516,512,512,508,504,504,504,504,504,504,508,508,512,512,512,516,520,524,528,528,528,532,528,528,528,524,520,520,516,512,512,512,512,512,512,516,516,516,516,516,516,512,508,500,492,484,480,476,476,476,476,480,484,492,496,504,508,512,516,520,520,524,528,528,532,532,532,528,528,524,520,516,516,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,516,516,520,524,524,528,532,536,536,540,540,540,536,536,532,520,512,504,492,480,464,460,452,448,448,456,460,464,476,488,496,504,512,520,528,536,544,548,552,552,552,548,544,540,532,528,520,512,508,504,500,496,496,492,496,500,504,508,512,512,512,520,524,524,524,524,528,528,524,524,520,520,516,516,512,512,512,512,508,508,508,508,512,512,512,512,512,512,512,512,512,508,500,500,496,492,492,492,492,492,496,496,500,500,504,508,512,512,516,524,528,536,540,544,544,548,548,544,540,536,528,524,516,512,504,500,492,488,484,480,476,476,476,476,476,480,484,492,496,504,512,516,520,528,532,536,540,540,540,540,540,536,536,536,532,532,532,532,528,528,528,524,520,516,512,508,496,492,484,476,468,468,464,464,468,472,480,488,496,508,512,516,524,532,536,540,540,544,544,540,536,532,524,516,512,504,500,496,492,488,488,488,488,492,500,504,508,512,516,520,524,528,532,536,536,536,536,536,536,536,536,532,532,532,528,528,528,528,524,524,524,520,520,520,520,516,516,512,508,504,496,488,480,476,468,468,464,464,468,472,480,488,500,508,512,524,532,540,544,548,548,548,544,536,532,524,516,512,504,496,488,484,484,480,484,484,488,492,496,504,508,512,516,524,528,528,532,532,532,532,532,532,528,528,528,528,528,524,524,524,528,528,528,532,532,532,532,532,520,512,508,496,480,468,460,452,448,448,452,456,464,476,488,496,504,512,524,532,540,544,548,548,548,548,544,540,532,524,516,512,504,500,496,492,492,492,492,496,500,500,504,512,512,512,520,520,524,528,528,532,532,532,532,532,532,528,528,524,520,520,520,516,516,512,512,512,512,508,504,504,500,496,492,488,484,480,480,480,480,484,488,492,496,504,508,512,516,520,528,528,532,536,536,536,540,536,536,532,528,528,524,520,516,512,512,508,508,508,508,508,508,508,508,508,508,508,508,508,508,508,508,508,512,512,512,512,512,516,516,520,520,520,524,524,524,528,528,528,528,532,528,520,512,512,496,484,472,464,460,456,460,464,472,484,496,504,512,516,524,528,532,532,536,532,528,528,524,520,516,512,512,512,512,512,512,512,512,512,508,504,504,500,500,500,504,508,512,524,536,548,564,576,584,592,596,596,580,548,532,508,468,444,424,420,408,428,448,460,484,500,512,516,516,516,516,516,512,512,516,512,516,512,512,508,508,508,508,512,520,524,528,536,528,520,512,500,484,476,472,476,484,500,512,528,544,552,552,552,544,532,528,520,512,512,508,504,504,508,512,512,516,524,532,544,556,568,572,576,580,572,556,512,488,468,420,408,400,416,432,460,504,512,532,540,532,516,508,492,484,492,496,504,524,524,532,528,524,520,512,524,532,540,552,564,548,540,516,488,464,448,444,448,472,492,512,524,536,528,524,516,508,500,504,508,512,516,520,524,524,528,528,532,540,548,548,560,560,556,564,564,552,552,548,536,512,460,460,420,388,404,412,460,476,524,548,536,540,520,496,480,480,476,500,528,528,552,556,540,532,512,516,512,516,544,540,536,540,512,476,468,444,444,456,484,512,524,540,536,520,512,508,492,504,512,512,524,528,516,512,512,508,512,524,536,544,548,556,544,540,548,536,548,568,572,576,588,572,536,460,444,412,360,412,428,488,512,536,544,492,488,460,436,456,488,504,524,560,532,532,536,516,536,536,568,564,556,572,532,504,496,476,452,484,476,492,496,492,488,472,480,480,488,508,528,516,536,528,512,516,508,512,524,536,544,556,556,560,548,544,544,528,536,548,548,564,580,580,576,556,536,448,404,428,356,408,448,496,524,516,552,472,464,464,440,456,500,508,500,540,516,504,536,536,560,556,568,556,508,520,500,476,508,520,504,528,512,496,484,472,480,476,504,512,516,512,528,500,512,512,496,512,512,512,512,528,528,540,552,568,556,544,552,524,532,552,560,588,616,608,600,572,528,436,388,416,356,416,468,508,512,500,512,432,444,452,452,476,520,504,492,524,508,532,584,612,604,568,548,480,448,476,496,512,560,540,516,512,476,464,472,492,484,488,492,484,492,532,544,564,564,524,492,476,468,492,532,580,584,576,556,516,508,512,532,560,584,592,596,596,588,564,536,428,396,412,368,452,484,560,524,508,508,396,416,440,432,460,500,464,468,512,516,572,600,632,576,512,508,452,476,540,564,560,572,516,484,468,492,488,500,512,488,464,484,496,516,552,556,524,500,468,448,472,512,548,564,576,552,532,528,528,520,536,544,528,540,564,576,624,640,632,592,544,432,292,380,372,428,524,584,576,472,516,420,392,468,456,428,452,452,432,512,596,628,620,632,564,444,472,476,496,552,604,552,524,520,496,492,512,512,460,456,456,440,492,544,532,540,528,492,472,488,500,508,528,532,524,532,544,536,536,552,524,504,512,516,512,560,576,596,620,640,608,568,552,488,340,336,432,412,512,540,588,488,444,504,404,452,480,420,404,424,464,516,612,664,624,552,548,468,452,512,536,544,560,564,536,532,548,540,484,484,408,376,420,492,524,552,572,524,484,488,476,484,504,516,520,520,552,544,540,572,544,524,524,500,492,508,536,556,572,600,588,568,588,576,552,548,524,444,304,408,468,496,556,556,560,404,448,452,400,452,452,448,468,520,580,608,604,604,508,488,516,472,512,512,556,544,572,608,556,520,492,456,428,436,440,444,456,512,520,544,552,508,484,468,484,504,512,536,516,516,544,556,568,552,516,496,480,500,512,540,560,544,544,552,548,552,552,532,548,564,552,548,536,496,352,412,492,488,468,448,520,412,480,544,508,492,460,492,492,532,568,552,516,528,512,528,568,528,520,480,536,544,552,560,508,476,452,488,496,488,476,448,452,508,520,524,508,500,504,500,536,536,496,500,496,524,548,548,564,524,520,536,532,532,504,500,496,504,524,552,564,556,556,536,528,528,544,540,524,528,512,440,356,472,512,536,488,512,532,444,520,504,512,452,472,512,500,532,504,548,520,540,548,520,512,476,496,524,548,540,516,488,512,512,536,524,492,456,424,456,476,500,500,504,516,532,540,520,504,496,484,508,524,532,544,548,560,556,528,520,508,488,500,520,528,536,532,532,520,516,524,508,512,512,512,532,540,564,572,548,504,408,488,516,520,472,476,516,448,516,508,520,492,480,516,480,508,484,520,540,524,524,512,508,496,504,532,548,540,548,520,520,496,504,496,476,480,456,480,480,512,516,504,504,488,512,516,532,532,512,524,528,548,544,528,524,512,524,520,520,508,496,512,512,516,512,536,540,536,528,508,512,512,524,540,552,568,556,548,468,468,512,496,472,432,504,468,492,512,504,508,472,516,492,500,484,492,524,532,540,512,524,516,512,524,544,528,512,500,520,528,520,528,492,476,456,460,468,484,504,484,496,512,520,528,528,528,516,528,540,540,532,520,528,524,520,512,492,500,508,528,536,532,528,528,540,540,536,512,508,508,520,544,540,552,540,528,476,484,512,508,476,460,508,464,484,488,500,488,472,512,492,508,504,520,536,532,552,536,532,512,504,512,512,520,516,512,512,516,520,516,512,508,488,480,468,472,472,472,484,500,512,512,516,524,528,540,548,544,528,512,520,524,524,520,516,512,512,520,524,524,520,524,528,524,524,512,512,512,512,516,512,516,524,524,528,500,508,528,532,516,496,512,492,480,476,488,492,476,496,508,500,496,508,520,512,512,520,512,508,512,516,524,516,520,512,512,520,516,516,504,500,500,500,504,488,488,488,492,500,496,500,496,500,516,532,548,548,544,536,532,532,520,512,508,512,520,528,536,536,528,528,532,536,528,516,512,512,524,524,524,532,512,508,520,524,504,468,496,504,488,476,484,492,460,472,488,480,476,488,516,512,512,520,528,524,524,532,536,528,532,524,528,520,516,520,512,516,504,504,508,500,496,480,476,476,480,488,496,500,508,512,516,524,532,528,532,536,540,536,528,528,524,528,528,520,512,512,520,524,528,532,528,520,520,520,524,524,528,524,512,500,512,520,508,484,496,508,488,468,476,496,480,480,492,492,480,484,512,512,512,520,532,532,528,536,540,540,536,528,520,516,512,512,512,516,508,496,492,492,492,488,484,476,480,484,496,500,508,512,512,520,528,532,536,536,536,532,528,528,524,528,524,520,520,516,516,516,516,520,524,524,524,524,524,528,524,528,528,512,500,508,516,504,476,496,512,492,468,472,492,476,480,492,492,484,496,516,516,512,520,528,528,524,524,528,528,524,524,524,528,516,516,512,512,500,492,496,492,484,484,492,492,488,492,504,508,504,508,512,520,524,524,528,532,536,536,532,528,524,528,532,528,516,512,516,520,516,512,512,508,508,512,512,512,512,516,520,524,528,524,520,516,520,524,512,504,512,516,512,492,492,500,492,488,492,496,488,488,500,500,500,508,512,512,512,512,516,520,524,520,520,520,516,516,520,516,512,512,508,500,500,496,500,500,504,504,504,508,512,512,516,520,520,520,520,524,528,528,528,524,524,520,516,516,516,520,512,512,512,508,508,508,512,512,512,512,516,516,520,524,524,528,524,520,516,524,520,512,508,512,512,500,492,492,492,484,484,488,488,488,492,500,496,496,504,508,512,512,512,512,512,516,520,524,528,524,520,520,516,512,512,516,512,512,512,512,512,512,512,512,512,512,508,512,512,512,516,520,520,516,516,516,516,520,520,520,516,516,516,516,516,512,512,512,512,508,504,504,508,512,508,508,508,512,512,512,512,512,516,520,524,524,524,524,524,524,524,520,516,512,508,508,508,504,500,496,492,492,488,488,488,488,492,500,504,508,512,512,516,520,524,524,524,528,528,528,524,524,524,520,516,516,516,512,512,512,512,512,512,512,512,516,520,520,528,532,532,532,528,524,520,516,516,512,500,496,496,492,484,476,476,476,472,476,480,484,492,500,508,512,512,516,520,524,528,532,536,536,536,536,532,528,524,516,512,508,500,496,492,492,492,488,492,492,492,496,504,512,512,516,524,532,536,540,540,540,536,536,532,532,528,528,520,516,512,512,508,504,500,496,496,496,496,492,492,496,500,500,504,508,508,512,512,512,516,516,520,524,524,524,524,524,524,524,524,524,520,516,516,512,512,512,512,512,512,512,512,512,512,508,508,508,504,504,504,504,500,500,500,500,504,504,508,508,512,512,516,516,520,520,520,520,524,524,524,524,524,524,520,516,516,516,512,512,508,508,504,504,504,500,500,504,504,508,508,508,512,512,512,512,516,516,516,520,516,516,516,512,512,512,508,508,504,500,500,496,496,492,496,496,496,496,500,504,504,508,512,512,516,516,520,524,524,524,528,528,524,524,524,524,520,520,516,516,516,516,516,516,516,516,516,516,516,516,516,516,516,516,516,516,512,512,512,512,512,508,504,504,504,500,500,496,496,496,496,500,500,504,504,508,512,512,512,516,516,516,516,516,516,516,516,516,516,512,512,512,512,512,508,508,508,508,508,508,508,508,512,512,512,512,516,516,516,520,520,524,524,524,524,524,520,520,516,516,512,512,512,512,508,508,504,504,504,504,504,504,504,504,500,504,504,504,508,512,512,512,512,512,512,516,516,512,512,512,516,516,516,516,516,516,516,516,512,512,516,516,516,512,516,516,516,516,512,512,512,512,512,512,512,512,512,508,508,508,508,508,508,508,508,508,508,508,508,512,512,512,512,512,512,516,512,516,516,512,512,512,512,512,512,512,512,512,512,508,508,508,508,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,508,508,508,512,508,508,508,512,512,512,512,512,512,516,516,516,516,516,516,520,520,516,516,516,516,516,516,512,512,512,512,512,512,512,512,508,512,512,508,508,508,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,508,508,508,508,508,508,512,512,512,512,512,512,512,512,512,512,512,516,516,516,516,516,516,516,516,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,504,508,512,512,512,512,520,512,512,512,516,512,516,512,512,512,512,512,508,512,508,512,508,508,508,508,508,508,508,512,512,512,512,512,512,512,512,512,512,516,516,516,516,516,516,516,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512
};
struct frame {
	float samples[FRAME_SIZE];
	float coefficients[ORDER+1];
};

struct frame frame_set[NUM_FRAMES];

float FRAME_MAP[74][10];

/**
 * Computes the multiplier to apply to a given sample in accordance with the hamming window filter equation.
 */
float hamming(int index, int frame_length) {
	return  0.53836 - 0.46164 * cos(2 * PI * index / (frame_length - 1));
}

/**
 * Populates the frame set by windowing each frame with a 21ms snippet (175 samples) and having a consecutive start-to-start
 * offset of 6ms (50 samples) for adjacent windows. If the hamming_flag is set high, then a hamming window filer is applied.
 */
void populate_frames(float* input_signal, int hamming_flag){
	for(int i = 0; i < NUM_FRAMES; i++){
		for(int j = 0; j < FRAME_SIZE; j++){
			if(hamming_flag){
				frame_set[i].samples[j] = input_signal[i*FRAME_OFFSET + j]*hamming(j,FRAME_SIZE);
			}else{
				frame_set[i].samples[j] = input_signal[i*FRAME_OFFSET + j];
			}
		}
	}
}

/**
 * Removes the offset from the MatLab recording.
 */
void remove_dc_offset(float* input_signal){
	for(int i = 0; i < INPUT_SIZE; i++){
		input_signal[i] = input_signal[i] - DC_OFFSET;
	}
}

/**
 * Locates the index of the first relevant sample at the start of the utterance.
 */
int getStartIndex(float* input_signal){
	int index = 0, count = 0;
	float energy[INPUT_SIZE] = {0};
	for(int i = 0; i < INPUT_SIZE; i++){
		energy[i] = input_signal[i]*input_signal[i];
	}
	for(int j = 0; j < INPUT_SIZE; j++){
		if(energy[j] > 10){
			if(count == 0){
				index = j;
				for(int k = index + 1; k < index + 20 && k < INPUT_SIZE; k++){
					if(energy[k] > 10){
						count++;
					}
				}
				if(count >= 7){
					break;
				}else{
					count = 0;
				}
			}
		}
	}
	return index;
}

/**
 * Isolates the window of relevant data.
 */
void  isolate_signal(float* input_signal, float* output_signal){
	int start = getStartIndex(input_signal);
	for(int i = start; i < WINDOW_SIZE + start && i < INPUT_SIZE; i++){
		output_signal[i - start] = input_signal[i];
	}
}

/**
 * Pre-emphasis high pass filtering in order to suppress low frequency. This
 * will reduce noise and average the transmission conditions and signal spectrum.
 *
 * Formula: y[n] = x[n] - a*x[n-1]
 */
void pre_emphasis_filter(float* input_signal, float* output_signal, float pre_emphasis_constant){
	for(int i = 0; i < WINDOW_SIZE; i++){
		output_signal[i] = input_signal[i];
		// Only subtract product with pre-emphasis constant for valid indices.
		if(i-1 >= 0){
			output_signal[i] -= pre_emphasis_constant*input_signal[i-1];
		}
	}
}

/**
 * Calculates the coefficients for the auto-correlation functions.
 */
void autocorrelation(float* input_signal, float* auto_coeff){
	int i,j;
	for(i = 0; i <= ORDER; i++){
		auto_coeff[i] = 0.0;
		for(j = i; j < FRAME_SIZE; j++){
			auto_coeff[i] += input_signal[j]*input_signal[j-i];
		}
	}
}

/**
 * Computes the LPC coefficients for a given frame by solving
 * the Toeplitz matrix using Durbin's algorithm.
 */
void lpc_coeff(float* coeff){
	int i,j;
	float sum,E,K,a[ORDER+1][ORDER+1];
	if(coeff[0] == 0){
		coeff[0] = 1.0E-30;
	}
	E = coeff[0];
	for(i = 1; i <= ORDER; i++){
		sum = 0.0;
		for(j = 1; j < i; j++){
			sum += a[j][i-1]*coeff[i-j];
		}
		K = (coeff[i] - sum) / E;
		a[i][i] = K;
		E *= (1 - K*K);
		for(j = 1; j < i; j++){
			a[j][i] = a[j][i-1] - K*a[i-j][i-1];
		}
	}
	for(i = 1; i <= ORDER; i++){
		coeff[i] = a[i][ORDER];
	}
}

void cepstrum_coeff(float* coeff){
	int i,n,k;
	float sum,h[ORDER+1];
	h[0] = coeff[0];
	h[1] = coeff[1];
	for(n = 2; n <= ORDER; n++){
		sum = 0.0;
		for(k = 1; k < n; k++){
			sum += ((float)k/(float)n)*h[k]*coeff[n-k];
		}
		h[n] = coeff[n] + sum;
	}
	for(i = 0; i <= ORDER; i++){
		coeff[i] = h[i];
	}
}

void LPC(float* input_signal) {
	printf("\n---Starting LPC algorithm---\n\n");

	float temp[WINDOW_SIZE] = {0};
	float isolated_input[WINDOW_SIZE] = {0};

	printf("Removing DC offset...");
	remove_dc_offset(input_signal);
	printf("SUCCESS\n");

	printf("Isolating signal...");
	isolate_signal(input_signal, temp);
	printf("SUCCESS\n");

	printf("Applying pre-emphasis filter...");
	pre_emphasis_filter(temp, isolated_input, 0.95);
	printf("SUCCESS\n");

	printf("Populating frames...");
	populate_frames(isolated_input,1);
	printf("SUCCESS\n");

	printf("Obtaining autocorrelation coefficients...");
	for(int i = 0; i < NUM_FRAMES; i++){
		autocorrelation(frame_set[i].samples, frame_set[i].coefficients);
	}
	printf("SUCCESS\n");

	printf("Obtaining LPC coefficients...");
	for(int j = 0; j < NUM_FRAMES; j++){
		lpc_coeff(frame_set[j].coefficients);
	}
	printf("SUCCESS\n");

	printf("Obtaining cepstrum coefficients...");
	for(int k = 0; k < NUM_FRAMES; k++){
		cepstrum_coeff(frame_set[k].coefficients);
	}
	printf("SUCCESS\n");

	printf("Converting results to two-dimensional array...");
	for(int l = 0; l < NUM_FRAMES; l++){
		for(int m = 0; m < FRAME_SIZE; m++){
			FRAME_MAP[l][m] = frame_set[l].coefficients[m];
		}
	}
	printf("SUCCESS\n");

	printf("\n---LPC algorithm COMPLETE---\n\n");
}

//int main(void){
//	LPC(test);
//	printf("\n---Printing Frames---\n\n");
//	for(int i = 0; i < NUM_FRAMES; i++){
//		printf("FRAME[%d]: ",i);
//		for(int j = 0; j <= ORDER; j++){
//			if(j != ORDER){
//				printf("%lf, ",FRAME_MAP[i][j]);//frame_set[i].coefficients[j]);
//			}else{
//				printf("%lf\n",FRAME_MAP[i][j]);//frame_set[i].coefficients[j]);
//			}
//		}
//	}
//	return EXIT_SUCCESS;
//}
